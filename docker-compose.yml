services:
  rust-compilation:
    image: rust:1.72
    working_dir: /newton
    command: [ "./startup.sh", "rust" ]
    volumes:
      - ./:/newton

  web:
    image: node:latest
    working_dir: /newton
    command: [ "./startup.sh", "web" ]
    ports: [ "3000:3000" ]
    depends_on:
      rust-compilation:
        condition: service_completed_successfully
    volumes:
      - ./:/newton
      - /newton/frontend/node_modules/
