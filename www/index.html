<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Newton's Method Fractals</title>
  </head>
  <body onload="change_poly(polynomial.value)">
    <noscript>This page contains webassembly and javascript content, please enable javascript in your browser.</noscript>

    <table>
      <tr>
        <td style="vertical-align: text-top; width: 50%;">

          <table>
            <tr>
              <td>Polynomial</td>
              <td>
                <select id="polynomial" onchange="change_poly(polynomial.value)">
                  <option value="-2, -2, 4, 4, -4, -3, -2 | 11, 7, 6, 5, 4, 1, 0" selected="true">2z^11 - 2z^7 + 4z^6 + 4z^5 - 4z^4 - 3z - 2</option>
                  <option value="1, -3, 1, -1 | 13, 6, 1, 0">z^13 - 3z^6 + z - 1</option>
                  <option value="-2, 3, 1, 1, 4, 5, 4 | 10, 8, 6, 4, 2, 1, 0">-2z^10 + 3z^8 + z^6 + z^4 + 4z^2 + 5z + 4</option>
                  <option value="1, 3, 1, 3 | 5, 3, 1, 0">z^5 + 3z^3 + z + 3</option>
                  <option value="1, 1, -2, 1 | 10, 8, 2, 0">z^10 + z^8 - 2z^2 + 1</option>
                  <option value="-3, -4, 2, -2, -4 | 10, 4, 2, 1, 0">-3z^10 - 4z^4 + z^2 - 2z - 4</option>
                  <option value="-2, -3, -1, 5 | 6, 3, 1, 0">-2z^6 - 3z^3 - z + 5</option>
                  <option value="-1, 4, -4 | 9, 5, 1">-z^9 + 4z^5 - 4z</option>
                  <option value="1, -4, 2, -3 | 7, 2, 1, 0">z^7 - 4z^2 + 2z - 3</option>
                  <option value="0 | 0">(Blank)</option>
                </select>
              </td>
            </tr>
            <tr>
              <td></td>
              <td>
                <table>
                  <tr>
                    <td><input id="z15" type="number" value="0" min="-5" max="5" style="width: 30px;">z^15+</td>
                    <td><input id="z14" type="number" value="0" min="-5" max="5" style="width: 30px;">z^14+</td>
                    <td><input id="z13" type="number" value="0" min="-5" max="5" style="width: 30px;">z^13+</td>
                    <td><input id="z12" type="number" value="0" min="-5" max="5" style="width: 30px;">z^12+</td>
                  </tr>
                  <tr>
                    <td><input id="z11" type="number" value="0" min="-5" max="5" style="width: 30px;">z^11+</td>
                    <td><input id="z10" type="number" value="0" min="-5" max="5" style="width: 30px;">z^10+</td>
                    <td><input id="z9" type="number" value="0" min="-5" max="5" style="width: 30px;">z^9+</td>
                    <td><input id="z8" type="number" value="0" min="-5" max="5" style="width: 30px;">z^8+</td>
                  </tr>
                  <tr>
                    <td><input id="z7" type="number" value="0" min="-5" max="5" style="width: 30px;">z^7+</td>
                    <td><input id="z6" type="number" value="0" min="-5" max="5" style="width: 30px;">z^6+</td>
                    <td><input id="z5" type="number" value="0" min="-5" max="5" style="width: 30px;">z^5+</td>
                    <td><input id="z4" type="number" value="0" min="-5" max="5" style="width: 30px;">z^4+</td>
                  </tr>
                  <tr>
                    <td><input id="z3" type="number" value="0" min="-5" max="5" style="width: 30px;">z^3+</td>
                    <td><input id="z2" type="number" value="0" min="-5" max="5" style="width: 30px;">z^2+</td>
                    <td><input id="z1" type="number" value="0" min="-5" max="5" style="width: 30px;">z+</td>
                    <td><input id="z0" type="number" value="0" min="-5" max="5" style="width: 30px;"></td>
                  </tr>
                </table>
              </td>
            </tr>
            <tr>
              <td>Method:</td>
              <td>
                <select id="method" onchange="change_method(method.value)">
                  <option value="0" selected="true">Newton's Method</option>
                  <option value="1">Halley's Method</option>
                  <option value="2">Householder's Method (O-3)</option>
                </select>
              </td>
            </tr>
            <tr>
              <td>Resolution:</td>
              <td>
                <select id="resolution">
                  <option value="200" selected="true">200x200</option>
                  <option value="400">400x400</option>
                  <option value="600">600x600</option>
                  <option value="800">800x800</option>
                </select>
              </td>
            </tr>
            <tr>
              <td>Loopmax:</td>
              <td>
                <input id="loopmax" type="range" min="20" max="200" value="200" oninput="loopmax_out.value = loopmax.value">
                <output id="loopmax_out">200</output>
              </td>
            </tr>
            <tr>
              <td>Color Saturation Factor:</td>
              <td>
                <input id="saturation" type="range" min="0" max="10" value="2" oninput="saturation_out.value = saturation.value">
                <output id="saturation_out">2</output>
              </td>
            </tr>
            <tr>
              <td>Show fractional loops</td>
              <td>
                <select id="showloops">
                  <option value="0" selected="true">False</option>
                  <option value="1">True</option>
                </select>
              </td>
            </tr>
            <tr>
              <td><button id="render" type="button">Render</button></td>
              <td><output id="render_time"></output></td>
            </tr>
          </table>
        </td>
        <td>
          <canvas id="fractal" style="border:1px solid #000000;"></canvas>
        </td>
      </tr>
    </table>

    <script src="./bootstrap.js"></script>
    <script>
      let change_method = (m) => {
        if (method.value == '0') {
          loopmax_out.value = loopmax.value = 200;
        } else if (method.value == '1') {
          loopmax_out.value = loopmax.value = 100;
        } else {
          loopmax_out.value = loopmax.value = 75;
        }
      }

      let change_poly = (p) => {
        let parts = p.split(" | ");
        let coef = parts[0].split(", ");
        let pow = parts[1].split(", ");

        for(var i=0; i<16; ++i) {
          document.getElementById("z" + i).value = 0;
        }
        for(var i=0; i<coef.length; ++i) {
          document.getElementById("z" + pow[i]).value = coef[i];
        }
      }
    </script>
  </body>
</html>
